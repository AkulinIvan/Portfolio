<!-- Privacy Policy Modal -->
<div class="modal fade" id="privacyModal" tabindex="-1" aria-labelledby="privacyModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="privacyModalLabel">
                    <i class="bi bi-shield-check me-2 text-gradient"></i>
                    Политика обработки персональных данных
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="text-content">
                    <!-- Содержимое модального окна -->
                    <div class="mb-4">
                        <h6 class="text-gradient mb-3">1. Общие положения</h6>
                        <p class="mb-3">
                            Настоящая политика обработки персональных данных составлена в соответствии 
                            с требованиями Федерального закона от 27.07.2006 №152-ФЗ «О персональных данных» 
                            и определяет порядок обработки персональных данных и меры по обеспечению 
                            безопасности персональных данных.
                        </p>
                    </div>

                    <div class="mb-4">
                        <h6 class="text-gradient mb-3">2. Основные понятия</h6>
                        <ul class="mb-3">
                            <li class="mb-2">
                                <strong>Персональные данные</strong> — любая информация, относящаяся прямо 
                                или косвенно к определенному или определяемому физическому лицу 
                                (субъекту персональных данных).
                            </li>
                            <li class="mb-2">
                                <strong>Обработка персональных данных</strong> — любое действие (операция) 
                                или совокупность действий (операций), совершаемых с использованием средств 
                                автоматизации или без использования таких средств с персональными данными.
                            </li>
                            <li>
                                <strong>Конфиденциальность персональных данных</strong> — обязательное для 
                                соблюдения требование не допускать их распространения без согласия субъекта 
                                персональных данных или наличия иного законного основания.
                            </li>
                        </ul>
                    </div>

                    <div class="mb-4">
                        <h6 class="text-gradient mb-3">3. Цели обработки персональных данных</h6>
                        <p class="mb-3">Обработка персональных данных осуществляется с целью:</p>
                        <ul class="mb-3">
                            <li class="mb-2">Установления обратной связи с пользователем</li>
                            <li class="mb-2">Предоставления информации о предоставляемых услугах</li>
                            <li class="mb-2">Заключения договоров и их исполнения</li>
                            <li class="mb-2">Информирования о новых проектах и услугах</li>
                            <li>Ответов на вопросы и оказания консультационной поддержки</li>
                        </ul>
                    </div>

                    <div class="mb-4">
                        <h6 class="text-gradient mb-3">4. Правовые основания обработки персональных данных</h6>
                        <p class="mb-3">
                            Обработка персональных данных осуществляется с согласия субъекта персональных 
                            данных на обработку его персональных данных. Согласие предоставляется 
                            путем проставления соответствующей отметки в форме обратной связи.
                        </p>
                    </div>

                    <div class="mb-4">
                        <h6 class="text-gradient mb-3">5. Состав обрабатываемых персональных данных</h6>
                        <p class="mb-3">При использовании формы обратной связи мы можем собирать:</p>
                        <ul class="mb-3">
                            <li class="mb-2">Имя и контактные данные (email, телефон)</li>
                            <li class="mb-2">Информацию о проекте или задаче</li>
                            <li class="mb-2">Прочие данные, которые вы предоставляете добровольно</li>
                            <li>Техническую информацию (IP-адрес, данные cookie)</li>
                        </ul>
                    </div>

                    <div class="mb-4">
                        <h6 class="text-gradient mb-3">6. Принципы обработки персональных данных</h6>
                        <ul class="mb-3">
                            <li class="mb-2">
                                <strong>Законность и справедливость:</strong> Обработка осуществляется 
                                на законных и справедливых основаниях.
                            </li>
                            <li class="mb-2">
                                <strong>Ограничение цели обработки:</strong> Данные собираются 
                                для конкретных, законных целей.
                            </li>
                            <li class="mb-2">
                                <strong>Минимизация данных:</strong> Собираются только те данные, 
                                которые необходимы для заявленных целей.
                            </li>
                            <li class="mb-2">
                                <strong>Точность:</strong> Принимаются меры для обеспечения точности 
                                и актуальности данных.
                            </li>
                            <li>
                                <strong>Безопасность:</strong> Обеспечивается защита данных 
                                от несанкционированного доступа.
                            </li>
                        </ul>
                    </div>

                    <div class="mb-4">
                        <h6 class="text-gradient mb-3">7. Сроки обработки персональных данных</h6>
                        <p class="mb-3">
                            Персональные данные обрабатываются в течение срока, необходимого для 
                            достижения целей обработки, если иное не предусмотрено законодательством РФ.
                        </p>
                    </div>

                    <div class="mb-4">
                        <h6 class="text-gradient mb-3">8. Права субъекта персональных данных</h6>
                        <p class="mb-3">Вы имеете право:</p>
                        <ul class="mb-3">
                            <li class="mb-2">Получать информацию об обработке ваших персональных данных</li>
                            <li class="mb-2">Требовать уточнения, блокирования или уничтожения данных</li>
                            <li class="mb-2">Отозвать согласие на обработку персональных данных</li>
                            <li class="mb-2">Обжаловать действия или бездействие при обработке данных</li>
                            <li>Осуществлять иные права, предусмотренные законодательством РФ</li>
                        </ul>
                    </div>

                    <div class="mb-4">
                        <h6 class="text-gradient mb-3">9. Меры по обеспечению безопасности</h6>
                        <p class="mb-3">
                            Принимаются необходимые организационные и технические меры для защиты 
                            персональных данных от неправомерного или случайного доступа, уничтожения, 
                            изменения, блокирования, копирования, распространения.
                        </p>
                    </div>

                    <div class="mb-4">
                        <h6 class="text-gradient mb-3">10. Заключительные положения</h6>
                        <p class="mb-3">
                            Настоящая политика может изменяться в одностороннем порядке. 
                            Новая редакция политики вступает в силу с момента ее размещения 
                            на сайте, если иное не предусмотрено новой редакцией политики.
                        </p>
                        <p class="mb-0">
                            В случае возникновения вопросов относительно настоящей политики 
                            вы можете связаться со мной по контактам, указанным на сайте.
                        </p>
                    </div>

                    <!-- Дата и контактная информация -->
                    <div class="mt-5 pt-4 border-top">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <p class="mb-2">
                                    <strong>Дата вступления в силу:</strong><br>
                                    {% now "d.m.Y" %}
                                </p>
                            </div>
                            <div class="col-md-6 mb-3">
                                <p class="mb-2">
                                    <strong>Контактная информация:</strong><br>
                                    {% if personal_info.email %}
                                    <a href="mailto:{{ personal_info.email }}" class="text-decoration-none">
                                        {{ personal_info.email }}
                                    </a>
                                    {% endif %}
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-outline-primary" data-bs-dismiss="modal">
                    <i class="bi bi-x-circle me-2"></i>Закрыть
                </button>
                <button type="button" class="btn btn-taiga" data-bs-dismiss="modal">
                    <i class="bi bi-check-circle me-2"></i>Понятно
                </button>
            </div>
        </div>
    </div>
</div>

<style>
    #privacyModal .modal-content {
        border: 1px solid var(--border-color);
        border-radius: 16px;
        overflow: hidden;
    }
    
    #privacyModal .modal-header {
        background: linear-gradient(135deg, var(--color-deep-forest), var(--color-pine-green));
        color: white;
        border-bottom: 1px solid var(--color-lichen);
    }
    
    #privacyModal .modal-body {
        max-height: 70vh;
        overflow-y: auto;
        padding: 2rem;
    }
    
    #privacyModal .modal-footer {
        background: var(--color-birch);
        border-top: 1px solid var(--border-color);
    }
    
    #privacyModal .text-content h6 {
        font-weight: 600;
        margin-bottom: 1rem;
        padding-bottom: 0.5rem;
        border-bottom: 2px solid var(--color-birch);
    }
    
    #privacyModal .text-content p {
        color: var(--text-secondary);
        line-height: 1.7;
        margin-bottom: 1rem;
    }
    
    #privacyModal .text-content ul {
        padding-left: 1.5rem;
        margin-bottom: 1.5rem;
    }
    
    #privacyModal .text-content li {
        color: var(--text-secondary);
        margin-bottom: 0.5rem;
        line-height: 1.6;
    }
    
    #privacyModal .text-content strong {
        color: var(--color-pine-green);
    }
    
    /* Скроллбар для модального окна */
    #privacyModal .modal-body::-webkit-scrollbar {
        width: 6px;
    }
    
    #privacyModal .modal-body::-webkit-scrollbar-track {
        background: var(--color-birch);
        border-radius: 3px;
    }
    
    #privacyModal .modal-body::-webkit-scrollbar-thumb {
        background: var(--color-lichen);
        border-radius: 3px;
    }
    
    #privacyModal .modal-body::-webkit-scrollbar-thumb:hover {
        background: var(--color-moss);
    }
    
    @media (max-width: 768px) {
        #privacyModal .modal-body {
            padding: 1.5rem;
        }
        
        #privacyModal .modal-dialog {
            margin: 1rem;
        }
    }
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Автоматическое скрытие модального окна при согласии
    const privacyModal = document.getElementById('privacyModal');
    const privacyCheckbox = document.getElementById('privacy');
    
    if (privacyModal && privacyCheckbox) {
        // При открытии модального окна
        privacyModal.addEventListener('show.bs.modal', function() {
            console.log('Пользователь открыл политику конфиденциальности');
        });
        
        // При закрытии модального окна
        privacyModal.addEventListener('hidden.bs.modal', function() {
            console.log('Пользователь закрыл политику конфиденциальности');
        });
        
        // При нажатии кнопки "Понятно"
        const understandBtn = privacyModal.querySelector('.btn-taiga');
        if (understandBtn) {
            understandBtn.addEventListener('click', function() {
                // Автоматически отмечаем чекбокс согласия
                if (privacyCheckbox) {
                    privacyCheckbox.checked = true;
                    console.log('Пользователь согласился с политикой конфиденциальности');
                }
                
                // Можно добавить отправку события в аналитику
                // ga('send', 'event', 'Privacy', 'Accepted');
            });
        }
    }
    
    // Валидация чекбокса
    const contactForm = document.getElementById('contactForm');
    if (contactForm) {
        contactForm.addEventListener('submit', function(e) {
            if (!privacyCheckbox.checked) {
                e.preventDefault();
                privacyCheckbox.focus();
                
                // Показываем уведомление
                const feedback = document.createElement('div');
                feedback.className = 'invalid-feedback d-block mt-2';
                feedback.textContent = 'Необходимо согласиться с политикой конфиденциальности';
                
                // Удаляем старое сообщение
                const oldFeedback = privacyCheckbox.parentNode.querySelector('.invalid-feedback');
                if (oldFeedback) {
                    oldFeedback.remove();
                }
                
                // Добавляем новое сообщение
                privacyCheckbox.parentNode.appendChild(feedback);
                
                // Показываем модальное окно
                const modal = new bootstrap.Modal(privacyModal);
                modal.show();
            }
        });
        
        // Скрываем сообщение об ошибке при изменении состояния чекбокса
        privacyCheckbox.addEventListener('change', function() {
            const feedback = this.parentNode.querySelector('.invalid-feedback');
            if (feedback && this.checked) {
                feedback.remove();
            }
        });
    }
});
</script>